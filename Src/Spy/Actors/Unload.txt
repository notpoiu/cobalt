local RelayChannel = get_comm_channel(...)

local wax = shared.CobaltActorEnv
local getrawmetatable = getrawmetatable or debug.getmetatable

RelayChannel.Event:Connect(function(Type, ...)
	if Type ~= "Unload" then
		return
	end

	local gameMetatable = getrawmetatable(game)

	if wax.shared.ExecutorSupport["oth"].IsWorking then
		pcall(oth.unhook, gameMetatable.__namecall, wax.shared.NamecallHook)
		pcall(oth.unhook, gameMetatable.__newindex, wax.shared.NewIndexHook)
	elseif restorefunction then
		pcall(restorefunction, gameMetatable.__namecall)
		pcall(restorefunction, gameMetatable.__newindex)
	end

	task.defer(function()
		shared.CobaltActorEnv = nil
	end)
end)
